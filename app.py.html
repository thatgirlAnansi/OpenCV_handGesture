<html>
<head>
<title>app.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
app.py</font>
</center></td></tr></table>
<pre><span class="s0">#!/usr/bin/env python</span>
<span class="s0"># -*- coding: utf-8 -*-</span>
<span class="s2">import </span><span class="s1">csv</span>
<span class="s2">import </span><span class="s1">copy</span>
<span class="s2">import </span><span class="s1">argparse</span>
<span class="s2">import </span><span class="s1">itertools</span>
<span class="s2">from </span><span class="s1">collections </span><span class="s2">import </span><span class="s1">Counter</span>
<span class="s2">from </span><span class="s1">collections </span><span class="s2">import </span><span class="s1">deque</span>

<span class="s2">import </span><span class="s1">cv2 </span><span class="s2">as </span><span class="s1">cv</span>
<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">mediapipe </span><span class="s2">as </span><span class="s1">mp</span>

<span class="s2">from </span><span class="s1">utils </span><span class="s2">import </span><span class="s1">CvFpsCalc</span>
<span class="s2">from </span><span class="s1">model </span><span class="s2">import </span><span class="s1">KeyPointClassifier</span>
<span class="s2">from </span><span class="s1">model </span><span class="s2">import </span><span class="s1">PointHistoryClassifier</span>


<span class="s2">def </span><span class="s1">get_args</span><span class="s3">():</span>
    <span class="s1">parser </span><span class="s3">= </span><span class="s1">argparse</span><span class="s3">.</span><span class="s1">ArgumentParser</span><span class="s3">()</span>

    <span class="s1">parser</span><span class="s3">.</span><span class="s1">add_argument</span><span class="s3">(</span><span class="s4">&quot;--device&quot;</span><span class="s3">, </span><span class="s1">type</span><span class="s3">=</span><span class="s1">int</span><span class="s3">, </span><span class="s1">default</span><span class="s3">=</span><span class="s5">0</span><span class="s3">)</span>
    <span class="s1">parser</span><span class="s3">.</span><span class="s1">add_argument</span><span class="s3">(</span><span class="s4">&quot;--width&quot;</span><span class="s3">, </span><span class="s1">help</span><span class="s3">=</span><span class="s4">'cap width'</span><span class="s3">, </span><span class="s1">type</span><span class="s3">=</span><span class="s1">int</span><span class="s3">, </span><span class="s1">default</span><span class="s3">=</span><span class="s5">960</span><span class="s3">)</span>
    <span class="s1">parser</span><span class="s3">.</span><span class="s1">add_argument</span><span class="s3">(</span><span class="s4">&quot;--height&quot;</span><span class="s3">, </span><span class="s1">help</span><span class="s3">=</span><span class="s4">'cap height'</span><span class="s3">, </span><span class="s1">type</span><span class="s3">=</span><span class="s1">int</span><span class="s3">, </span><span class="s1">default</span><span class="s3">=</span><span class="s5">540</span><span class="s3">)</span>

    <span class="s1">parser</span><span class="s3">.</span><span class="s1">add_argument</span><span class="s3">(</span><span class="s4">'--use_static_image_mode'</span><span class="s3">, </span><span class="s1">action</span><span class="s3">=</span><span class="s4">'store_true'</span><span class="s3">)</span>
    <span class="s1">parser</span><span class="s3">.</span><span class="s1">add_argument</span><span class="s3">(</span><span class="s4">&quot;--min_detection_confidence&quot;</span><span class="s3">,</span>
                        <span class="s1">help</span><span class="s3">=</span><span class="s4">'min_detection_confidence'</span><span class="s3">,</span>
                        <span class="s1">type</span><span class="s3">=</span><span class="s1">float</span><span class="s3">,</span>
                        <span class="s1">default</span><span class="s3">=</span><span class="s5">0.7</span><span class="s3">)</span>
    <span class="s1">parser</span><span class="s3">.</span><span class="s1">add_argument</span><span class="s3">(</span><span class="s4">&quot;--min_tracking_confidence&quot;</span><span class="s3">,</span>
                        <span class="s1">help</span><span class="s3">=</span><span class="s4">'min_tracking_confidence'</span><span class="s3">,</span>
                        <span class="s1">type</span><span class="s3">=</span><span class="s1">int</span><span class="s3">,</span>
                        <span class="s1">default</span><span class="s3">=</span><span class="s5">0.5</span><span class="s3">)</span>

    <span class="s1">args </span><span class="s3">= </span><span class="s1">parser</span><span class="s3">.</span><span class="s1">parse_args</span><span class="s3">()</span>

    <span class="s2">return </span><span class="s1">args</span>


<span class="s2">def </span><span class="s1">main</span><span class="s3">():</span>
    <span class="s0"># Argument parsing #################################################################</span>
    <span class="s1">args </span><span class="s3">= </span><span class="s1">get_args</span><span class="s3">()</span>

    <span class="s1">cap_device </span><span class="s3">= </span><span class="s1">args</span><span class="s3">.</span><span class="s1">device</span>
    <span class="s1">cap_width </span><span class="s3">= </span><span class="s1">args</span><span class="s3">.</span><span class="s1">width</span>
    <span class="s1">cap_height </span><span class="s3">= </span><span class="s1">args</span><span class="s3">.</span><span class="s1">height</span>

    <span class="s1">use_static_image_mode </span><span class="s3">= </span><span class="s1">args</span><span class="s3">.</span><span class="s1">use_static_image_mode</span>
    <span class="s1">min_detection_confidence </span><span class="s3">= </span><span class="s1">args</span><span class="s3">.</span><span class="s1">min_detection_confidence</span>
    <span class="s1">min_tracking_confidence </span><span class="s3">= </span><span class="s1">args</span><span class="s3">.</span><span class="s1">min_tracking_confidence</span>

    <span class="s1">use_brect </span><span class="s3">= </span><span class="s2">True</span>

    <span class="s0"># Camera preparation ###############################################################</span>
    <span class="s1">cap </span><span class="s3">= </span><span class="s1">cv</span><span class="s3">.</span><span class="s1">VideoCapture</span><span class="s3">(</span><span class="s1">cap_device</span><span class="s3">)</span>
    <span class="s1">cap</span><span class="s3">.</span><span class="s1">set</span><span class="s3">(</span><span class="s1">cv</span><span class="s3">.</span><span class="s1">CAP_PROP_FRAME_WIDTH</span><span class="s3">, </span><span class="s1">cap_width</span><span class="s3">)</span>
    <span class="s1">cap</span><span class="s3">.</span><span class="s1">set</span><span class="s3">(</span><span class="s1">cv</span><span class="s3">.</span><span class="s1">CAP_PROP_FRAME_HEIGHT</span><span class="s3">, </span><span class="s1">cap_height</span><span class="s3">)</span>

    <span class="s0"># Model load #############################################################</span>
    <span class="s1">mp_hands </span><span class="s3">= </span><span class="s1">mp</span><span class="s3">.</span><span class="s1">solutions</span><span class="s3">.</span><span class="s1">hands</span>
    <span class="s1">hands </span><span class="s3">= </span><span class="s1">mp_hands</span><span class="s3">.</span><span class="s1">Hands</span><span class="s3">(</span>
        <span class="s1">static_image_mode</span><span class="s3">=</span><span class="s1">use_static_image_mode</span><span class="s3">,</span>
        <span class="s1">max_num_hands</span><span class="s3">=</span><span class="s5">2</span><span class="s3">,</span>
        <span class="s1">min_detection_confidence</span><span class="s3">=</span><span class="s1">min_detection_confidence</span><span class="s3">,</span>
        <span class="s1">min_tracking_confidence</span><span class="s3">=</span><span class="s1">min_tracking_confidence</span><span class="s3">,</span>
    <span class="s3">)</span>

    <span class="s1">keypoint_classifier </span><span class="s3">= </span><span class="s1">KeyPointClassifier</span><span class="s3">()</span>

    <span class="s1">point_history_classifier </span><span class="s3">= </span><span class="s1">PointHistoryClassifier</span><span class="s3">()</span>

    <span class="s0"># Read labels ###########################################################</span>
    <span class="s2">with </span><span class="s1">open</span><span class="s3">(</span><span class="s4">'model/keypoint_classifier/keypoint_classifier_label.csv'</span><span class="s3">,</span>
              <span class="s1">encoding</span><span class="s3">=</span><span class="s4">'utf-8-sig'</span><span class="s3">) </span><span class="s2">as </span><span class="s1">f</span><span class="s3">:</span>
        <span class="s1">keypoint_classifier_labels </span><span class="s3">= </span><span class="s1">csv</span><span class="s3">.</span><span class="s1">reader</span><span class="s3">(</span><span class="s1">f</span><span class="s3">)</span>
        <span class="s1">keypoint_classifier_labels </span><span class="s3">= [</span>
            <span class="s1">row</span><span class="s3">[</span><span class="s5">0</span><span class="s3">] </span><span class="s2">for </span><span class="s1">row </span><span class="s2">in </span><span class="s1">keypoint_classifier_labels</span>
        <span class="s3">]</span>
    <span class="s2">with </span><span class="s1">open</span><span class="s3">(</span>
            <span class="s4">'model/point_history_classifier/point_history_classifier_label.csv'</span><span class="s3">,</span>
            <span class="s1">encoding</span><span class="s3">=</span><span class="s4">'utf-8-sig'</span><span class="s3">) </span><span class="s2">as </span><span class="s1">f</span><span class="s3">:</span>
        <span class="s1">point_history_classifier_labels </span><span class="s3">= </span><span class="s1">csv</span><span class="s3">.</span><span class="s1">reader</span><span class="s3">(</span><span class="s1">f</span><span class="s3">)</span>
        <span class="s1">point_history_classifier_labels </span><span class="s3">= [</span>
            <span class="s1">row</span><span class="s3">[</span><span class="s5">0</span><span class="s3">] </span><span class="s2">for </span><span class="s1">row </span><span class="s2">in </span><span class="s1">point_history_classifier_labels</span>
        <span class="s3">]</span>

    <span class="s0"># FPS Measurement ########################################################</span>
    <span class="s1">cvFpsCalc </span><span class="s3">= </span><span class="s1">CvFpsCalc</span><span class="s3">(</span><span class="s1">buffer_len</span><span class="s3">=</span><span class="s5">10</span><span class="s3">)</span>

    <span class="s0"># Coordinate history #################################################################</span>
    <span class="s1">history_length </span><span class="s3">= </span><span class="s5">16</span>
    <span class="s1">point_history </span><span class="s3">= </span><span class="s1">deque</span><span class="s3">(</span><span class="s1">maxlen</span><span class="s3">=</span><span class="s1">history_length</span><span class="s3">)</span>

    <span class="s0"># Finger gesture history ################################################</span>
    <span class="s1">finger_gesture_history </span><span class="s3">= </span><span class="s1">deque</span><span class="s3">(</span><span class="s1">maxlen</span><span class="s3">=</span><span class="s1">history_length</span><span class="s3">)</span>

    <span class="s0">#  ########################################################################</span>
    <span class="s1">mode </span><span class="s3">= </span><span class="s5">0</span>

    <span class="s2">while True</span><span class="s3">:</span>
        <span class="s1">fps </span><span class="s3">= </span><span class="s1">cvFpsCalc</span><span class="s3">.</span><span class="s1">get</span><span class="s3">()</span>

        <span class="s0"># Process Key (ESC: end) #################################################</span>
        <span class="s1">key </span><span class="s3">= </span><span class="s1">cv</span><span class="s3">.</span><span class="s1">waitKey</span><span class="s3">(</span><span class="s5">10</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">key </span><span class="s3">== </span><span class="s5">27</span><span class="s3">:  </span><span class="s0"># ESC</span>
            <span class="s2">break</span>
        <span class="s1">number</span><span class="s3">, </span><span class="s1">mode </span><span class="s3">= </span><span class="s1">select_mode</span><span class="s3">(</span><span class="s1">key</span><span class="s3">, </span><span class="s1">mode</span><span class="s3">)</span>

        <span class="s0"># Camera capture #####################################################</span>
        <span class="s1">ret</span><span class="s3">, </span><span class="s1">image </span><span class="s3">= </span><span class="s1">cap</span><span class="s3">.</span><span class="s1">read</span><span class="s3">()</span>
        <span class="s2">if not </span><span class="s1">ret</span><span class="s3">:</span>
            <span class="s2">break</span>
        <span class="s1">image </span><span class="s3">= </span><span class="s1">cv</span><span class="s3">.</span><span class="s1">flip</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s5">1</span><span class="s3">)  </span><span class="s0"># Mirror display</span>
        <span class="s1">debug_image </span><span class="s3">= </span><span class="s1">copy</span><span class="s3">.</span><span class="s1">deepcopy</span><span class="s3">(</span><span class="s1">image</span><span class="s3">)</span>

        <span class="s0"># Detection implementation #############################################################</span>
        <span class="s1">image </span><span class="s3">= </span><span class="s1">cv</span><span class="s3">.</span><span class="s1">cvtColor</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">cv</span><span class="s3">.</span><span class="s1">COLOR_BGR2RGB</span><span class="s3">)</span>

        <span class="s1">image</span><span class="s3">.</span><span class="s1">flags</span><span class="s3">.</span><span class="s1">writeable </span><span class="s3">= </span><span class="s2">False</span>
        <span class="s1">results </span><span class="s3">= </span><span class="s1">hands</span><span class="s3">.</span><span class="s1">process</span><span class="s3">(</span><span class="s1">image</span><span class="s3">)</span>
        <span class="s1">image</span><span class="s3">.</span><span class="s1">flags</span><span class="s3">.</span><span class="s1">writeable </span><span class="s3">= </span><span class="s2">True</span>

        <span class="s0">#  ####################################################################</span>
        <span class="s2">if </span><span class="s1">results</span><span class="s3">.</span><span class="s1">multi_hand_landmarks </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s2">for </span><span class="s1">hand_landmarks</span><span class="s3">, </span><span class="s1">handedness </span><span class="s2">in </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">results</span><span class="s3">.</span><span class="s1">multi_hand_landmarks</span><span class="s3">,</span>
                                                  <span class="s1">results</span><span class="s3">.</span><span class="s1">multi_handedness</span><span class="s3">):</span>
                <span class="s0"># Bounding box calculation</span>
                <span class="s1">brect </span><span class="s3">= </span><span class="s1">calc_bounding_rect</span><span class="s3">(</span><span class="s1">debug_image</span><span class="s3">, </span><span class="s1">hand_landmarks</span><span class="s3">)</span>
                <span class="s0"># Landmark calculation</span>
                <span class="s1">landmark_list </span><span class="s3">= </span><span class="s1">calc_landmark_list</span><span class="s3">(</span><span class="s1">debug_image</span><span class="s3">, </span><span class="s1">hand_landmarks</span><span class="s3">)</span>

                <span class="s0"># Conversion to relative coordinates / normalized coordinates</span>
                <span class="s1">pre_processed_landmark_list </span><span class="s3">= </span><span class="s1">pre_process_landmark</span><span class="s3">(</span>
                    <span class="s1">landmark_list</span><span class="s3">)</span>
                <span class="s1">pre_processed_point_history_list </span><span class="s3">= </span><span class="s1">pre_process_point_history</span><span class="s3">(</span>
                    <span class="s1">debug_image</span><span class="s3">, </span><span class="s1">point_history</span><span class="s3">)</span>
                <span class="s0"># Write to the dataset file</span>
                <span class="s1">logging_csv</span><span class="s3">(</span><span class="s1">number</span><span class="s3">, </span><span class="s1">mode</span><span class="s3">, </span><span class="s1">pre_processed_landmark_list</span><span class="s3">,</span>
                            <span class="s1">pre_processed_point_history_list</span><span class="s3">)</span>

                <span class="s0"># Hand sign classification</span>
                <span class="s1">hand_sign_id </span><span class="s3">= </span><span class="s1">keypoint_classifier</span><span class="s3">(</span><span class="s1">pre_processed_landmark_list</span><span class="s3">)</span>
                <span class="s2">if </span><span class="s1">hand_sign_id </span><span class="s3">== </span><span class="s5">2</span><span class="s3">:  </span><span class="s0"># Point gesture</span>
                    <span class="s1">point_history</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">landmark_list</span><span class="s3">[</span><span class="s5">8</span><span class="s3">])</span>
                <span class="s2">else</span><span class="s3">:</span>
                    <span class="s1">point_history</span><span class="s3">.</span><span class="s1">append</span><span class="s3">([</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">])</span>

                <span class="s0"># Finger gesture classification</span>
                <span class="s1">finger_gesture_id </span><span class="s3">= </span><span class="s5">0</span>
                <span class="s1">point_history_len </span><span class="s3">= </span><span class="s1">len</span><span class="s3">(</span><span class="s1">pre_processed_point_history_list</span><span class="s3">)</span>
                <span class="s2">if </span><span class="s1">point_history_len </span><span class="s3">== (</span><span class="s1">history_length </span><span class="s3">* </span><span class="s5">2</span><span class="s3">):</span>
                    <span class="s1">finger_gesture_id </span><span class="s3">= </span><span class="s1">point_history_classifier</span><span class="s3">(</span>
                        <span class="s1">pre_processed_point_history_list</span><span class="s3">)</span>

                <span class="s0"># Calculates the gesture IDs in the latest detection</span>
                <span class="s1">finger_gesture_history</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">finger_gesture_id</span><span class="s3">)</span>
                <span class="s1">most_common_fg_id </span><span class="s3">= </span><span class="s1">Counter</span><span class="s3">(</span>
                    <span class="s1">finger_gesture_history</span><span class="s3">).</span><span class="s1">most_common</span><span class="s3">()</span>

                <span class="s0"># Drawing part</span>
                <span class="s1">debug_image </span><span class="s3">= </span><span class="s1">draw_bounding_rect</span><span class="s3">(</span><span class="s1">use_brect</span><span class="s3">, </span><span class="s1">debug_image</span><span class="s3">, </span><span class="s1">brect</span><span class="s3">)</span>
                <span class="s1">debug_image </span><span class="s3">= </span><span class="s1">draw_landmarks</span><span class="s3">(</span><span class="s1">debug_image</span><span class="s3">, </span><span class="s1">landmark_list</span><span class="s3">)</span>
                <span class="s1">debug_image </span><span class="s3">= </span><span class="s1">draw_info_text</span><span class="s3">(</span>
                    <span class="s1">debug_image</span><span class="s3">,</span>
                    <span class="s1">brect</span><span class="s3">,</span>
                    <span class="s1">handedness</span><span class="s3">,</span>
                    <span class="s1">keypoint_classifier_labels</span><span class="s3">[</span><span class="s1">hand_sign_id</span><span class="s3">],</span>
                    <span class="s1">point_history_classifier_labels</span><span class="s3">[</span><span class="s1">most_common_fg_id</span><span class="s3">[</span><span class="s5">0</span><span class="s3">][</span><span class="s5">0</span><span class="s3">]],</span>
                <span class="s3">)</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">point_history</span><span class="s3">.</span><span class="s1">append</span><span class="s3">([</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">])</span>

        <span class="s1">debug_image </span><span class="s3">= </span><span class="s1">draw_point_history</span><span class="s3">(</span><span class="s1">debug_image</span><span class="s3">, </span><span class="s1">point_history</span><span class="s3">)</span>
        <span class="s1">debug_image </span><span class="s3">= </span><span class="s1">draw_info</span><span class="s3">(</span><span class="s1">debug_image</span><span class="s3">, </span><span class="s1">fps</span><span class="s3">, </span><span class="s1">mode</span><span class="s3">, </span><span class="s1">number</span><span class="s3">)</span>

        <span class="s0"># Screen reflection #############################################################</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">imshow</span><span class="s3">(</span><span class="s4">'Hand Gesture Recognition'</span><span class="s3">, </span><span class="s1">debug_image</span><span class="s3">)</span>

    <span class="s1">cap</span><span class="s3">.</span><span class="s1">release</span><span class="s3">()</span>
    <span class="s1">cv</span><span class="s3">.</span><span class="s1">destroyAllWindows</span><span class="s3">()</span>


<span class="s2">def </span><span class="s1">select_mode</span><span class="s3">(</span><span class="s1">key</span><span class="s3">, </span><span class="s1">mode</span><span class="s3">):</span>
    <span class="s1">number </span><span class="s3">= -</span><span class="s5">1</span>
    <span class="s2">if </span><span class="s5">48 </span><span class="s3">&lt;= </span><span class="s1">key </span><span class="s3">&lt;= </span><span class="s5">57</span><span class="s3">:  </span><span class="s0"># 0 ~ 9</span>
        <span class="s1">number </span><span class="s3">= </span><span class="s1">key </span><span class="s3">- </span><span class="s5">48</span>
    <span class="s2">if </span><span class="s1">key </span><span class="s3">== </span><span class="s5">110</span><span class="s3">:  </span><span class="s0"># n</span>
        <span class="s1">mode </span><span class="s3">= </span><span class="s5">0</span>
    <span class="s2">if </span><span class="s1">key </span><span class="s3">== </span><span class="s5">107</span><span class="s3">:  </span><span class="s0"># k</span>
        <span class="s1">mode </span><span class="s3">= </span><span class="s5">1</span>
    <span class="s2">if </span><span class="s1">key </span><span class="s3">== </span><span class="s5">104</span><span class="s3">:  </span><span class="s0"># h</span>
        <span class="s1">mode </span><span class="s3">= </span><span class="s5">2</span>
    <span class="s2">return </span><span class="s1">number</span><span class="s3">, </span><span class="s1">mode</span>


<span class="s2">def </span><span class="s1">calc_bounding_rect</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">landmarks</span><span class="s3">):</span>
    <span class="s1">image_width</span><span class="s3">, </span><span class="s1">image_height </span><span class="s3">= </span><span class="s1">image</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">[</span><span class="s5">1</span><span class="s3">], </span><span class="s1">image</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]</span>

    <span class="s1">landmark_array </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">empty</span><span class="s3">((</span><span class="s5">0</span><span class="s3">, </span><span class="s5">2</span><span class="s3">), </span><span class="s1">int</span><span class="s3">)</span>

    <span class="s2">for </span><span class="s1">_</span><span class="s3">, </span><span class="s1">landmark </span><span class="s2">in </span><span class="s1">enumerate</span><span class="s3">(</span><span class="s1">landmarks</span><span class="s3">.</span><span class="s1">landmark</span><span class="s3">):</span>
        <span class="s1">landmark_x </span><span class="s3">= </span><span class="s1">min</span><span class="s3">(</span><span class="s1">int</span><span class="s3">(</span><span class="s1">landmark</span><span class="s3">.</span><span class="s1">x </span><span class="s3">* </span><span class="s1">image_width</span><span class="s3">), </span><span class="s1">image_width </span><span class="s3">- </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s1">landmark_y </span><span class="s3">= </span><span class="s1">min</span><span class="s3">(</span><span class="s1">int</span><span class="s3">(</span><span class="s1">landmark</span><span class="s3">.</span><span class="s1">y </span><span class="s3">* </span><span class="s1">image_height</span><span class="s3">), </span><span class="s1">image_height </span><span class="s3">- </span><span class="s5">1</span><span class="s3">)</span>

        <span class="s1">landmark_point </span><span class="s3">= [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">((</span><span class="s1">landmark_x</span><span class="s3">, </span><span class="s1">landmark_y</span><span class="s3">))]</span>

        <span class="s1">landmark_array </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">landmark_array</span><span class="s3">, </span><span class="s1">landmark_point</span><span class="s3">, </span><span class="s1">axis</span><span class="s3">=</span><span class="s5">0</span><span class="s3">)</span>

    <span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">, </span><span class="s1">w</span><span class="s3">, </span><span class="s1">h </span><span class="s3">= </span><span class="s1">cv</span><span class="s3">.</span><span class="s1">boundingRect</span><span class="s3">(</span><span class="s1">landmark_array</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s3">[</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">, </span><span class="s1">x </span><span class="s3">+ </span><span class="s1">w</span><span class="s3">, </span><span class="s1">y </span><span class="s3">+ </span><span class="s1">h</span><span class="s3">]</span>


<span class="s2">def </span><span class="s1">calc_landmark_list</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">landmarks</span><span class="s3">):</span>
    <span class="s1">image_width</span><span class="s3">, </span><span class="s1">image_height </span><span class="s3">= </span><span class="s1">image</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">[</span><span class="s5">1</span><span class="s3">], </span><span class="s1">image</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]</span>

    <span class="s1">landmark_point </span><span class="s3">= []</span>

    <span class="s0"># Keypoint</span>
    <span class="s2">for </span><span class="s1">_</span><span class="s3">, </span><span class="s1">landmark </span><span class="s2">in </span><span class="s1">enumerate</span><span class="s3">(</span><span class="s1">landmarks</span><span class="s3">.</span><span class="s1">landmark</span><span class="s3">):</span>
        <span class="s1">landmark_x </span><span class="s3">= </span><span class="s1">min</span><span class="s3">(</span><span class="s1">int</span><span class="s3">(</span><span class="s1">landmark</span><span class="s3">.</span><span class="s1">x </span><span class="s3">* </span><span class="s1">image_width</span><span class="s3">), </span><span class="s1">image_width </span><span class="s3">- </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s1">landmark_y </span><span class="s3">= </span><span class="s1">min</span><span class="s3">(</span><span class="s1">int</span><span class="s3">(</span><span class="s1">landmark</span><span class="s3">.</span><span class="s1">y </span><span class="s3">* </span><span class="s1">image_height</span><span class="s3">), </span><span class="s1">image_height </span><span class="s3">- </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s0"># landmark_z = landmark.z</span>

        <span class="s1">landmark_point</span><span class="s3">.</span><span class="s1">append</span><span class="s3">([</span><span class="s1">landmark_x</span><span class="s3">, </span><span class="s1">landmark_y</span><span class="s3">])</span>

    <span class="s2">return </span><span class="s1">landmark_point</span>


<span class="s2">def </span><span class="s1">pre_process_landmark</span><span class="s3">(</span><span class="s1">landmark_list</span><span class="s3">):</span>
    <span class="s1">temp_landmark_list </span><span class="s3">= </span><span class="s1">copy</span><span class="s3">.</span><span class="s1">deepcopy</span><span class="s3">(</span><span class="s1">landmark_list</span><span class="s3">)</span>

    <span class="s0"># Convert to relative coordinates</span>
    <span class="s1">base_x</span><span class="s3">, </span><span class="s1">base_y </span><span class="s3">= </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span>
    <span class="s2">for </span><span class="s1">index</span><span class="s3">, </span><span class="s1">landmark_point </span><span class="s2">in </span><span class="s1">enumerate</span><span class="s3">(</span><span class="s1">temp_landmark_list</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">0</span><span class="s3">:</span>
            <span class="s1">base_x</span><span class="s3">, </span><span class="s1">base_y </span><span class="s3">= </span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]</span>

        <span class="s1">temp_landmark_list</span><span class="s3">[</span><span class="s1">index</span><span class="s3">][</span><span class="s5">0</span><span class="s3">] = </span><span class="s1">temp_landmark_list</span><span class="s3">[</span><span class="s1">index</span><span class="s3">][</span><span class="s5">0</span><span class="s3">] - </span><span class="s1">base_x</span>
        <span class="s1">temp_landmark_list</span><span class="s3">[</span><span class="s1">index</span><span class="s3">][</span><span class="s5">1</span><span class="s3">] = </span><span class="s1">temp_landmark_list</span><span class="s3">[</span><span class="s1">index</span><span class="s3">][</span><span class="s5">1</span><span class="s3">] - </span><span class="s1">base_y</span>

    <span class="s0"># Convert to a one-dimensional list</span>
    <span class="s1">temp_landmark_list </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span>
        <span class="s1">itertools</span><span class="s3">.</span><span class="s1">chain</span><span class="s3">.</span><span class="s1">from_iterable</span><span class="s3">(</span><span class="s1">temp_landmark_list</span><span class="s3">))</span>

    <span class="s0"># Normalization</span>
    <span class="s1">max_value </span><span class="s3">= </span><span class="s1">max</span><span class="s3">(</span><span class="s1">list</span><span class="s3">(</span><span class="s1">map</span><span class="s3">(</span><span class="s1">abs</span><span class="s3">, </span><span class="s1">temp_landmark_list</span><span class="s3">)))</span>

    <span class="s2">def </span><span class="s1">normalize_</span><span class="s3">(</span><span class="s1">n</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">n </span><span class="s3">/ </span><span class="s1">max_value</span>

    <span class="s1">temp_landmark_list </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">map</span><span class="s3">(</span><span class="s1">normalize_</span><span class="s3">, </span><span class="s1">temp_landmark_list</span><span class="s3">))</span>

    <span class="s2">return </span><span class="s1">temp_landmark_list</span>


<span class="s2">def </span><span class="s1">pre_process_point_history</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">point_history</span><span class="s3">):</span>
    <span class="s1">image_width</span><span class="s3">, </span><span class="s1">image_height </span><span class="s3">= </span><span class="s1">image</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">[</span><span class="s5">1</span><span class="s3">], </span><span class="s1">image</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]</span>

    <span class="s1">temp_point_history </span><span class="s3">= </span><span class="s1">copy</span><span class="s3">.</span><span class="s1">deepcopy</span><span class="s3">(</span><span class="s1">point_history</span><span class="s3">)</span>

    <span class="s0"># Convert to relative coordinates</span>
    <span class="s1">base_x</span><span class="s3">, </span><span class="s1">base_y </span><span class="s3">= </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span>
    <span class="s2">for </span><span class="s1">index</span><span class="s3">, </span><span class="s1">point </span><span class="s2">in </span><span class="s1">enumerate</span><span class="s3">(</span><span class="s1">temp_point_history</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">0</span><span class="s3">:</span>
            <span class="s1">base_x</span><span class="s3">, </span><span class="s1">base_y </span><span class="s3">= </span><span class="s1">point</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">point</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]</span>

        <span class="s1">temp_point_history</span><span class="s3">[</span><span class="s1">index</span><span class="s3">][</span><span class="s5">0</span><span class="s3">] = (</span><span class="s1">temp_point_history</span><span class="s3">[</span><span class="s1">index</span><span class="s3">][</span><span class="s5">0</span><span class="s3">] -</span>
                                        <span class="s1">base_x</span><span class="s3">) / </span><span class="s1">image_width</span>
        <span class="s1">temp_point_history</span><span class="s3">[</span><span class="s1">index</span><span class="s3">][</span><span class="s5">1</span><span class="s3">] = (</span><span class="s1">temp_point_history</span><span class="s3">[</span><span class="s1">index</span><span class="s3">][</span><span class="s5">1</span><span class="s3">] -</span>
                                        <span class="s1">base_y</span><span class="s3">) / </span><span class="s1">image_height</span>

    <span class="s0"># Convert to a one-dimensional list</span>
    <span class="s1">temp_point_history </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span>
        <span class="s1">itertools</span><span class="s3">.</span><span class="s1">chain</span><span class="s3">.</span><span class="s1">from_iterable</span><span class="s3">(</span><span class="s1">temp_point_history</span><span class="s3">))</span>

    <span class="s2">return </span><span class="s1">temp_point_history</span>


<span class="s2">def </span><span class="s1">logging_csv</span><span class="s3">(</span><span class="s1">number</span><span class="s3">, </span><span class="s1">mode</span><span class="s3">, </span><span class="s1">landmark_list</span><span class="s3">, </span><span class="s1">point_history_list</span><span class="s3">):</span>
    <span class="s2">if </span><span class="s1">mode </span><span class="s3">== </span><span class="s5">0</span><span class="s3">:</span>
        <span class="s2">pass</span>
    <span class="s2">if </span><span class="s1">mode </span><span class="s3">== </span><span class="s5">1 </span><span class="s2">and </span><span class="s3">(</span><span class="s5">0 </span><span class="s3">&lt;= </span><span class="s1">number </span><span class="s3">&lt;= </span><span class="s5">9</span><span class="s3">):</span>
        <span class="s1">csv_path </span><span class="s3">= </span><span class="s4">'model/keypoint_classifier/keypoint.csv'</span>
        <span class="s2">with </span><span class="s1">open</span><span class="s3">(</span><span class="s1">csv_path</span><span class="s3">, </span><span class="s4">'a'</span><span class="s3">, </span><span class="s1">newline</span><span class="s3">=</span><span class="s4">&quot;&quot;</span><span class="s3">) </span><span class="s2">as </span><span class="s1">f</span><span class="s3">:</span>
            <span class="s1">writer </span><span class="s3">= </span><span class="s1">csv</span><span class="s3">.</span><span class="s1">writer</span><span class="s3">(</span><span class="s1">f</span><span class="s3">)</span>
            <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">([</span><span class="s1">number</span><span class="s3">, *</span><span class="s1">landmark_list</span><span class="s3">])</span>
    <span class="s2">if </span><span class="s1">mode </span><span class="s3">== </span><span class="s5">2 </span><span class="s2">and </span><span class="s3">(</span><span class="s5">0 </span><span class="s3">&lt;= </span><span class="s1">number </span><span class="s3">&lt;= </span><span class="s5">9</span><span class="s3">):</span>
        <span class="s1">csv_path </span><span class="s3">= </span><span class="s4">'model/point_history_classifier/point_history.csv'</span>
        <span class="s2">with </span><span class="s1">open</span><span class="s3">(</span><span class="s1">csv_path</span><span class="s3">, </span><span class="s4">'a'</span><span class="s3">, </span><span class="s1">newline</span><span class="s3">=</span><span class="s4">&quot;&quot;</span><span class="s3">) </span><span class="s2">as </span><span class="s1">f</span><span class="s3">:</span>
            <span class="s1">writer </span><span class="s3">= </span><span class="s1">csv</span><span class="s3">.</span><span class="s1">writer</span><span class="s3">(</span><span class="s1">f</span><span class="s3">)</span>
            <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">([</span><span class="s1">number</span><span class="s3">, *</span><span class="s1">point_history_list</span><span class="s3">])</span>
    <span class="s2">return</span>


<span class="s2">def </span><span class="s1">draw_landmarks</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">landmark_point</span><span class="s3">):</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">) &gt; </span><span class="s5">0</span><span class="s3">:</span>
        <span class="s0"># Thumb</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">2</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">3</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">2</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">3</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">3</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">4</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">3</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">4</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>

        <span class="s0"># Index finger</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">5</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">6</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">5</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">6</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">6</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">7</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">6</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">7</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">7</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">8</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">7</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">8</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>

        <span class="s0"># Middle finger</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">9</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">10</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">9</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">10</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">10</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">11</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">10</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">11</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">11</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">12</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">11</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">12</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>

        <span class="s0"># Ring finger</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">13</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">14</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">13</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">14</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">14</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">15</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">14</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">15</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">15</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">16</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">15</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">16</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>

        <span class="s0"># Little finger</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">17</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">18</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">17</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">18</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">18</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">19</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">18</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">19</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">19</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">20</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">19</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">20</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>

        <span class="s0"># Palm</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">2</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">2</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">2</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">5</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">2</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">5</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">5</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">9</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">5</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">9</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">9</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">13</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">9</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">13</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">13</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">17</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">13</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">17</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">17</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">6</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">line</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">17</span><span class="s3">]), </span><span class="s1">tuple</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]),</span>
                <span class="s3">(</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>

    <span class="s0"># Key Points</span>
    <span class="s2">for </span><span class="s1">index</span><span class="s3">, </span><span class="s1">landmark </span><span class="s2">in </span><span class="s1">enumerate</span><span class="s3">(</span><span class="s1">landmark_point</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">0</span><span class="s3">:  </span><span class="s0"># 手首1</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">1</span><span class="s3">:  </span><span class="s0"># 手首2</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">2</span><span class="s3">:  </span><span class="s0"># 親指：付け根</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">3</span><span class="s3">:  </span><span class="s0"># 親指：第1関節</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">4</span><span class="s3">:  </span><span class="s0"># 親指：指先</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">8</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">8</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">5</span><span class="s3">:  </span><span class="s0"># 人差指：付け根</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">6</span><span class="s3">:  </span><span class="s0"># 人差指：第2関節</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">7</span><span class="s3">:  </span><span class="s0"># 人差指：第1関節</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">8</span><span class="s3">:  </span><span class="s0"># 人差指：指先</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">8</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">8</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">9</span><span class="s3">:  </span><span class="s0"># 中指：付け根</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">10</span><span class="s3">:  </span><span class="s0"># 中指：第2関節</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">11</span><span class="s3">:  </span><span class="s0"># 中指：第1関節</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">12</span><span class="s3">:  </span><span class="s0"># 中指：指先</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">8</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">8</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">13</span><span class="s3">:  </span><span class="s0"># 薬指：付け根</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">14</span><span class="s3">:  </span><span class="s0"># 薬指：第2関節</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">15</span><span class="s3">:  </span><span class="s0"># 薬指：第1関節</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">16</span><span class="s3">:  </span><span class="s0"># 薬指：指先</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">8</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">8</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">17</span><span class="s3">:  </span><span class="s0"># 小指：付け根</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">18</span><span class="s3">:  </span><span class="s0"># 小指：第2関節</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">19</span><span class="s3">:  </span><span class="s0"># 小指：第1関節</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">5</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s5">20</span><span class="s3">:  </span><span class="s0"># 小指：指先</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">8</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">),</span>
                      <span class="s3">-</span><span class="s5">1</span><span class="s3">)</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">landmark</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">8</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">image</span>


<span class="s2">def </span><span class="s1">draw_bounding_rect</span><span class="s3">(</span><span class="s1">use_brect</span><span class="s3">, </span><span class="s1">image</span><span class="s3">, </span><span class="s1">brect</span><span class="s3">):</span>
    <span class="s2">if </span><span class="s1">use_brect</span><span class="s3">:</span>
        <span class="s0"># Outer rectangle</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">rectangle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">brect</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">brect</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), (</span><span class="s1">brect</span><span class="s3">[</span><span class="s5">2</span><span class="s3">], </span><span class="s1">brect</span><span class="s3">[</span><span class="s5">3</span><span class="s3">]),</span>
                     <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">1</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">image</span>


<span class="s2">def </span><span class="s1">draw_info_text</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">brect</span><span class="s3">, </span><span class="s1">handedness</span><span class="s3">, </span><span class="s1">hand_sign_text</span><span class="s3">,</span>
                   <span class="s1">finger_gesture_text</span><span class="s3">):</span>
    <span class="s1">cv</span><span class="s3">.</span><span class="s1">rectangle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">brect</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">brect</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), (</span><span class="s1">brect</span><span class="s3">[</span><span class="s5">2</span><span class="s3">], </span><span class="s1">brect</span><span class="s3">[</span><span class="s5">1</span><span class="s3">] - </span><span class="s5">22</span><span class="s3">),</span>
                 <span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), -</span><span class="s5">1</span><span class="s3">)</span>

    <span class="s1">info_text </span><span class="s3">= </span><span class="s1">handedness</span><span class="s3">.</span><span class="s1">classification</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">label</span><span class="s3">[</span><span class="s5">0</span><span class="s3">:]</span>
    <span class="s2">if </span><span class="s1">hand_sign_text </span><span class="s3">!= </span><span class="s4">&quot;&quot;</span><span class="s3">:</span>
        <span class="s1">info_text </span><span class="s3">= </span><span class="s1">info_text </span><span class="s3">+ </span><span class="s4">':' </span><span class="s3">+ </span><span class="s1">hand_sign_text</span>
    <span class="s1">cv</span><span class="s3">.</span><span class="s1">putText</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">info_text</span><span class="s3">, (</span><span class="s1">brect</span><span class="s3">[</span><span class="s5">0</span><span class="s3">] + </span><span class="s5">5</span><span class="s3">, </span><span class="s1">brect</span><span class="s3">[</span><span class="s5">1</span><span class="s3">] - </span><span class="s5">4</span><span class="s3">),</span>
               <span class="s1">cv</span><span class="s3">.</span><span class="s1">FONT_HERSHEY_SIMPLEX</span><span class="s3">, </span><span class="s5">0.6</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">1</span><span class="s3">, </span><span class="s1">cv</span><span class="s3">.</span><span class="s1">LINE_AA</span><span class="s3">)</span>

    <span class="s2">if </span><span class="s1">finger_gesture_text </span><span class="s3">!= </span><span class="s4">&quot;&quot;</span><span class="s3">:</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">putText</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s4">&quot;Finger Gesture:&quot; </span><span class="s3">+ </span><span class="s1">finger_gesture_text</span><span class="s3">, (</span><span class="s5">10</span><span class="s3">, </span><span class="s5">60</span><span class="s3">),</span>
                   <span class="s1">cv</span><span class="s3">.</span><span class="s1">FONT_HERSHEY_SIMPLEX</span><span class="s3">, </span><span class="s5">1.0</span><span class="s3">, (</span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">4</span><span class="s3">, </span><span class="s1">cv</span><span class="s3">.</span><span class="s1">LINE_AA</span><span class="s3">)</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">putText</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s4">&quot;Finger Gesture:&quot; </span><span class="s3">+ </span><span class="s1">finger_gesture_text</span><span class="s3">, (</span><span class="s5">10</span><span class="s3">, </span><span class="s5">60</span><span class="s3">),</span>
                   <span class="s1">cv</span><span class="s3">.</span><span class="s1">FONT_HERSHEY_SIMPLEX</span><span class="s3">, </span><span class="s5">1.0</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">2</span><span class="s3">,</span>
                   <span class="s1">cv</span><span class="s3">.</span><span class="s1">LINE_AA</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">image</span>


<span class="s2">def </span><span class="s1">draw_point_history</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">point_history</span><span class="s3">):</span>
    <span class="s2">for </span><span class="s1">index</span><span class="s3">, </span><span class="s1">point </span><span class="s2">in </span><span class="s1">enumerate</span><span class="s3">(</span><span class="s1">point_history</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">point</span><span class="s3">[</span><span class="s5">0</span><span class="s3">] != </span><span class="s5">0 </span><span class="s2">and </span><span class="s1">point</span><span class="s3">[</span><span class="s5">1</span><span class="s3">] != </span><span class="s5">0</span><span class="s3">:</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">circle</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, (</span><span class="s1">point</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">point</span><span class="s3">[</span><span class="s5">1</span><span class="s3">]), </span><span class="s5">1 </span><span class="s3">+ </span><span class="s1">int</span><span class="s3">(</span><span class="s1">index </span><span class="s3">/ </span><span class="s5">2</span><span class="s3">),</span>
                      <span class="s3">(</span><span class="s5">152</span><span class="s3">, </span><span class="s5">251</span><span class="s3">, </span><span class="s5">152</span><span class="s3">), </span><span class="s5">2</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">image</span>


<span class="s2">def </span><span class="s1">draw_info</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s1">fps</span><span class="s3">, </span><span class="s1">mode</span><span class="s3">, </span><span class="s1">number</span><span class="s3">):</span>
    <span class="s1">cv</span><span class="s3">.</span><span class="s1">putText</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s4">&quot;Hand Gesture detection&quot; </span><span class="s3">, (</span><span class="s5">10</span><span class="s3">, </span><span class="s5">30</span><span class="s3">), </span><span class="s1">cv</span><span class="s3">.</span><span class="s1">FONT_HERSHEY_SIMPLEX</span><span class="s3">,</span>
               <span class="s5">1.0</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">0</span><span class="s3">), </span><span class="s5">2</span><span class="s3">, </span><span class="s1">cv</span><span class="s3">.</span><span class="s1">LINE_AA</span><span class="s3">)</span>

    <span class="s1">mode_string </span><span class="s3">= [</span><span class="s4">'Logging Key Point'</span><span class="s3">, </span><span class="s4">'Logging Point History'</span><span class="s3">]</span>
    <span class="s2">if </span><span class="s5">1 </span><span class="s3">&lt;= </span><span class="s1">mode </span><span class="s3">&lt;= </span><span class="s5">2</span><span class="s3">:</span>
        <span class="s1">cv</span><span class="s3">.</span><span class="s1">putText</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s4">&quot;MODE:&quot; </span><span class="s3">+ </span><span class="s1">mode_string</span><span class="s3">[</span><span class="s1">mode </span><span class="s3">- </span><span class="s5">1</span><span class="s3">], (</span><span class="s5">10</span><span class="s3">, </span><span class="s5">90</span><span class="s3">),</span>
                   <span class="s1">cv</span><span class="s3">.</span><span class="s1">FONT_HERSHEY_SIMPLEX</span><span class="s3">, </span><span class="s5">0.6</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">1</span><span class="s3">,</span>
                   <span class="s1">cv</span><span class="s3">.</span><span class="s1">LINE_AA</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s5">0 </span><span class="s3">&lt;= </span><span class="s1">number </span><span class="s3">&lt;= </span><span class="s5">9</span><span class="s3">:</span>
            <span class="s1">cv</span><span class="s3">.</span><span class="s1">putText</span><span class="s3">(</span><span class="s1">image</span><span class="s3">, </span><span class="s4">&quot;NUM:&quot; </span><span class="s3">+ </span><span class="s1">str</span><span class="s3">(</span><span class="s1">number</span><span class="s3">), (</span><span class="s5">10</span><span class="s3">, </span><span class="s5">110</span><span class="s3">),</span>
                       <span class="s1">cv</span><span class="s3">.</span><span class="s1">FONT_HERSHEY_SIMPLEX</span><span class="s3">, </span><span class="s5">0.6</span><span class="s3">, (</span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">, </span><span class="s5">255</span><span class="s3">), </span><span class="s5">1</span><span class="s3">,</span>
                       <span class="s1">cv</span><span class="s3">.</span><span class="s1">LINE_AA</span><span class="s3">)</span>
    <span class="s2">return </span><span class="s1">image</span>


<span class="s2">if </span><span class="s1">__name__ </span><span class="s3">== </span><span class="s4">'__main__'</span><span class="s3">:</span>
    <span class="s1">main</span><span class="s3">()</span>
</pre>
</body>
</html>